---
import Layout from "../layouts/Layout.astro";
import "../styles/main.css";
---

<Layout>
  <div class="landing">
    <div id="bird-container"></div>
    <div class="landing-content">
      <h1 class="landing-title">Hugivar</h1>
      <p class="landing-subtitle">
        Personal philosophy and thoughts on engineering
      </p>
      <div class="landing-links">
        <a href="https://compile.substack.com/" class="landing-link">Journal</a>
        <a href="https://github.com/hugivar" class="landing-link">GitHub</a>
      </div>
    </div>
    <div class="landing-theme-toggle">
      <button
        id="theme-toggle"
        class="theme-toggle"
        aria-label="Toggle theme"
      ></button>
    </div>
  </div>
</Layout>

<script>
  // Theme toggle
  const btn = document.getElementById("theme-toggle")!;
  function updateButton() {
    const isDark = document.documentElement.classList.contains("dark");
    btn.textContent = isDark ? "\u2600" : "\u263D";
    btn.setAttribute(
      "aria-label",
      isDark ? "Switch to light mode" : "Switch to dark mode",
    );
  }
  updateButton();
  btn.addEventListener("click", () => {
    document.documentElement.classList.toggle("dark");
    const isDark = document.documentElement.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
    updateButton();
  });

  // Bird SVG animation
  fetch("/bird.svg")
    .then((res) => res.text())
    .then((svgText) => {
      const parser = new DOMParser();
      const doc = parser.parseFromString(svgText, "image/svg+xml");
      const svg = doc.querySelector("svg");
      const container = document.getElementById("bird-container");
      if (!svg || !container) return;

      svg.setAttribute("class", "bird-svg");
      svg.setAttribute("aria-hidden", "true");

      const paths = svg.querySelectorAll("path");
      if (paths.length > 0) paths[0].remove();

      svg.querySelectorAll("path").forEach((path, i) => {
        const length = path.getTotalLength();
        path.setAttribute("stroke", "currentColor");
        path.setAttribute("fill", "none");
        path.setAttribute("stroke-width", "1.5");
        path.style.strokeDasharray = `${length}`;
        path.style.strokeDashoffset = `${length}`;
        path.style.animation = `draw 2s ease forwards ${i * 0.15}s`;
      });

      container.appendChild(svg);
    });
</script>
